<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device--width, initial-scale=1.0">
    <title>Pacific Star Resort Spa - Room Service</title>
    <!-- Chosen Palette: Warm Neutral Harmony -->
    <!-- Application Structure Plan: A single-page application structure was chosen for a fluid, app-like user experience, preventing page reloads. The main view features category filters and a menu grid for easy Browse. An item detail modal allows users to customize and add items without losing their place on the menu. A slide-out cart provides a non-intrusive way to review the order at any time. New buttons for order history and multilingual support enhance guest accessibility and information management directly from the header. This task-oriented flow (Browse -> Select -> Customize -> Review -> Manage History/Language) is intuitive, mirroring popular food delivery apps as recommended by the source report, ensuring high usability for a wide range of hotel guests. -->
    <!-- Visualization & Content Choices: The core of the application is the visual menu, presented as a grid of cards (HTML/CSS) for optimal scannability, following the report's emphasis on "browsability." Category buttons (HTML/CSS) allow for interactive filtering (JS) of the menu. For customization, a modal view (JS-controlled) was selected to provide detailed information and options (quantity, special requests) without navigating away. The shopping cart is a slide-out panel, a common and effective pattern for summarizing order details dynamically. New "Order History" and "Language" buttons (HTML/CSS) are added to the header; the language button triggers a simple language selection dropdown (HTML/JS) for demonstration. All interactions are handled with vanilla JavaScript, adhering to the NO SVG/Mermaid constraint. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #F8F7F5; /* Warm neutral background */
        }
        .active-category {
            background-color: #D97706; /* Amber-700 */
            color: white;
            font-weight: 700;
        }
        .category-btn {
            transition: all 0.3s ease;
        }
        .menu-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        /* Custom scrollbar for better aesthetics */
        .custom-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 0px; /* Make the scrollbar width 0px */
            background: transparent; /* Hide the scrollbar background */
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: transparent; /* Hide the scrollbar thumb */
        }

        /* Screensaver specific styles */
        #screensaver {
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background-color: black; /* Solid black background */
        }
        #screensaver.visible {
            opacity: 1;
        }
        #screensaver-image {
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
    </style>
</head>
<body class="flex flex-col h-screen text-gray-800">

    <!-- Fixed Header and Category Area -->
    <div id="fixed-header-area" class="fixed top-0 w-full bg-[#F8F7F5] z-30 shadow-sm">
        <div class="max-w-7xl mx-auto py-3 px-4 md:px-6 pb-3">
            <!-- Header -->
            <header class="flex justify-between items-center mb-1">
                <div>
                    <h1 id="app-title" class="text-3xl font-bold text-amber-800">Pacific Star Resort Spa</h1>
                    <p id="app-subtitle" class="text-gray-500">객실 1205호 | 룸서비스</p>
                </div>
                <div class="flex space-x-2">
                    <button id="order-history-button" class="py-2 px-4 bg-white border border-gray-200 rounded-full shadow-sm text-gray-700 hover:bg-gray-50 transition">
                        <i class="fa-solid fa-history"></i>
                        <span class="ml-2">주문 내역</span>
                    </button>
                    <div class="relative">
                        <button id="language-button" class="py-2 px-4 bg-white border border-gray-200 rounded-full shadow-sm text-gray-700 hover:bg-gray-50 transition">
                            <i class="fa-solid fa-globe"></i>
                            <span class="ml-2">다국어</span>
                        </button>
                        <div id="language-dropdown" class="absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg py-1 z-10 hidden">
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-lang="ko">한국어</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-lang="en">English</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-lang="ja">日本語</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-lang="zh">中文</a>
                        </div>
                    </div>
                    <button id="cart-button" class="relative py-2 px-4 bg-white border border-gray-200 rounded-full shadow-sm text-gray-700 hover:bg-gray-50 transition">
                        <i class="fa-solid fa-cart-shopping"></i>
                        <span class="ml-2">내 장바구니</span>
                        <span id="cart-count" class="absolute -top-2 -right-2 bg-amber-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
                    </button>
                </div>
            </header>

            <!-- Category Filters -->
            <nav class="mb-1">
                <p class="text-lg font-semibold mb-1">어떤 메뉴를 찾고 계신가요?</p>
                <div id="category-filters" class="flex flex-wrap gap-2 md:gap-4 pb-0">
                    <!-- Category buttons will be inserted here by JS -->
                </div>
            </nav>
            
            <!-- Menu Instruction -->
            <p id="menu-instruction" class="text-sm text-gray-500 pt-0 pb-0">원하시는 메뉴를 눌러 상세정보를 확인하고 주문하세요.</p>
        </div>
    </div>

    <!-- Scrollable Main Content -->
    <main class="flex-grow overflow-y-auto custom-scrollbar">
        <div class="max-w-7xl mx-auto p-4 md:p-6 pt-6">
            <div id="menu-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Menu items will be inserted here by JS -->
            </div>
        </div>
    </main>

    <!-- Item Detail Modal -->
    <div id="detail-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden transition-opacity duration-300">
        <div id="modal-content" class="bg-white rounded-lg shadow-2xl w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col transform scale-95 transition-transform duration-300">
            <!-- Modal content will be inserted here by JS -->
        </div>
    </div>

    <!-- Order History Modal -->
    <div id="history-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden transition-opacity duration-300">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col transform scale-95 transition-transform duration-300">
            <div class="flex justify-between items-center p-6 border-b">
                <h2 class="text-2xl font-bold text-amber-800">주문 내역</h2>
                <button id="close-history-button" class="text-gray-500 hover:text-gray-800 transition">
                    <i class="fa-solid fa-times fa-xl"></i>
                </button>
            </div>
            <div id="history-items" class="flex-grow p-6 overflow-y-auto custom-scrollbar">
                <!-- Order history items will be inserted here by JS -->
            </div>
            <div class="p-6 border-t bg-gray-50">
                <button id="clear-history-button" class="w-full bg-red-500 text-white font-bold py-3 rounded-lg hover:bg-red-600 transition shadow-lg disabled:bg-gray-400">
                    <i class="fa-solid fa-trash-alt mr-2"></i>
                    주문 내역 지우기 (데모)
                </button>
            </div>
        </div>
    </div>

    <!-- Shopping Cart Sidebar -->
    <div id="cart-sidebar" class="fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-2xl z-50 transform translate-x-full transition-transform duration-300 flex flex-col">
        <div class="flex justify-between items-center p-6 border-b">
            <h2 class="text-2xl font-bold text-amber-800">주문 내역</h2>
            <button id="close-cart-button" class="text-gray-500 hover:text-gray-800 transition">
                <i class="fa-solid fa-times fa-xl"></i>
                </button>
        </div>
        <div id="cart-items" class="flex-grow p-6 overflow-y-auto custom-scrollbar">
            <!-- Cart items will be inserted here by JS -->
        </div>
        <div class="p-6 border-t bg-gray-50">
            <div class="flex justify-between items-center mb-4 text-lg">
                <span class="font-semibold">예상 총액</span>
                <span id="cart-total" class="font-bold text-xl text-amber-700">0원</span>
            </div>
             <p class="text-xs text-gray-500 mb-4">*세금 및 봉사료가 포함된 금액입니다.</p>
            <button id="checkout-button" class="w-full bg-amber-600 text-white font-bold py-3 rounded-lg hover:bg-amber-700 transition shadow-lg disabled:bg-gray-400">
                <i class="fa-solid fa-check-circle mr-2"></i>
                <span id="checkout-button-text">객실로 주문하기</span>
            </button>
        </div>
    </div>

    <!-- Screensaver -->
    <div id="screensaver" class="fixed inset-0 flex items-center justify-center bg-black z-40 hidden">
        <img id="screensaver-image" src="" alt="" class="w-full h-full object-cover">
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const NO_IMAGE_PLACEHOLDER = 'https://placehold.co/600x400/cccccc/000000?text=No+Image';

    const menuData = [
        { id: 'm01', name: '클래식 비프 버거', category: '메인', price: 28000, description: '100% 소고기 패티, 체다 치즈, 신선한 야채가 어우러진 시그니처 버거. 감자튀김 포함.', image: 'https://images.pexels.com/photos/1639557/pexels-photo-1639557.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' },
        { id: 'm02', name: '트러플 크림 파스타', category: '메인', price: 32000, description: '진한 트러플 향이 가득한 크림소스와 쫄깃한 페투치네 면의 조화.', image: 'https://images.pexels.com/photos/1279330/pexels-photo-1279330.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' },
        { id: 'm03', name: '마르게리타 피자', category: '메인', price: 25000, description: '신선한 토마토 소스, 모짜렐라 치즈, 바질로 맛을 낸 정통 이탈리안 피자.', image: 'https://images.pexels.com/photos/2619967/pexels-photo-2619967.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' }, // Updated Image URL for Margarita Pizza
        { id: 'm04', name: '시저 샐러드', category: '에피타이저', price: 18000, description: '신선한 로메인 상추, 크루통, 파마산 치즈를 호텔 특제 시저 드레싱과 함께 즐겨보세요.', image: 'https://images.pexels.com/photos/1059905/pexels-photo-1059905.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' },
        { id: 'm05', name: '오늘의 스프', category: '에피타이저', price: 12000, description: '셰프가 매일 신선한 재료로 정성껏 끓여낸 오늘의 특선 스프입니다.', image: 'https://images.pexels.com/photos/5982888/pexels-photo-5982888.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' },
        { id: 'd01', name: '아메리카노', category: '음료', price: 8000, description: '깊고 진한 풍미의 원두로 내린 신선한 아메리카노 (Hot/Ice 선택 가능)', image: 'https://images.pexels.com/photos/302899/pexels-photo-302899.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' },
        { id: 'd02', name: '생과일 오렌지 주스', category: '음료', price: 12000, description: '주문 즉시 착즙하여 만드는 100% 신선한 오렌지 주스입니다.', image: 'https://images.pexels.com/photos/2261058/pexels-photo-2261058.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' }, // Updated Image URL for Orange Juice
        { id: 'd03', name: '콜라', category: '음료', price: 5000, description: '시원하고 청량한 콜라.', image: 'https://images.pexels.com/photos/50593/coca-cola-cold-drink-soft-drink-coke-50593.jpeg' }, // Added Cola
        { id: 's01', name: '감자튀김 추가', category: '사이드', price: 7000, description: '바삭하게 튀겨낸 감자튀김을 더 푸짐하게 즐겨보세요.', image: 'https://images.pexels.com/photos/1583884/pexels-photo-1583884.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' },
        { id: 'ds01', name: '뉴욕 치즈케이크', category: '디저트', price: 15000, description: '부드럽고 진한 크림치즈의 맛이 일품인 정통 뉴욕 스타일 치즈케이크.', image: 'https://images.pexels.com/photos/2067420/pexels-photo-2067420.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' },
        { id: 'ds02', name: '계절 과일 플래터', category: '디저트', price: 22000, description: '셰프가 엄선한 신선한 제철 과일 모둠입니다.', image: 'https://images.pexels.com/photos/1346342/pexels-photo-1346342.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' },
    ];

    const categories = ['전체', ...new Set(menuData.map(item => item.category))];
    let cart = [];
    let orderHistory = []; // 주문 내역을 저장할 배열
    let activeCategory = '전체';
    let currentLanguage = 'ko'; // 현재 언어 설정

    const translations = {
        ko: {
            hotelName: "Pacific Star Resort Spa",
            roomInfo: "객실 1205호 | 룸서비스",
            cartButton: "내 장바구니",
            categoryPrompt: "어떤 메뉴를 찾고 계신가요?",
            menuPrompt: "원하시는 메뉴를 눌러 상세정보를 확인하고 주문하세요.",
            orderHistoryButton: "주문 내역",
            languageButton: "다국어",
            orderHistoryTitle: "주문 내역",
            orderHistoryEmpty: "주문 내역이 없습니다.",
            orderHistoryClear: "주문 내역 지우기 (데모)",
            orderSummaryTitle: "주문 내역",
            expectedTotal: "예상 총액",
            taxNotice: "*세금 및 봉사료가 포함된 금액입니다.",
            placeOrder: "객실로 주문하기",
            cartEmpty: "장바구니가 비어있습니다.",
            quantity: "수량",
            specialRequests: "특별 요청사항",
            specialRequestsPlaceholder: "알레르기 정보나 기타 요청사항을 입력해주세요.",
            addToCartBtn: "장바구니에 담기",
            orderProcessing: "주문 처리 중...",
            orderCompleteAlert: "주문이 완료되었습니다.\\n총 주문 금액: {total}\\n객실로 곧 배달될 예정입니다.",
            itemRemoved: "항목이 장바구니에서 삭제되었습니다.",
            orderConfirmed: "주문이 성공적으로 접수되었습니다! (이것은 데모 주문입니다)",
            orderFailEmptyCart: "장바구니가 비어있습니다. 메뉴를 선택해주세요."
        },
        en: {
            hotelName: "Pacific Star Resort Spa",
            roomInfo: "Room 1205 | Room Service",
            cartButton: "My Cart",
            categoryPrompt: "What are you looking for?",
            menuPrompt: "Click on a menu item for details and to order.",
            orderHistoryButton: "Order History",
            languageButton: "Language",
            orderHistoryTitle: "Order History",
            orderHistoryEmpty: "No order history available.",
            orderHistoryClear: "Clear Order History (Demo)",
            orderSummaryTitle: "Order Summary",
            expectedTotal: "Estimated Total",
            taxNotice: "*Taxes and service charges included.",
            placeOrder: "Order to Room",
            cartEmpty: "Your cart is empty.",
            quantity: "Quantity",
            specialRequests: "Special Requests",
            specialRequestsPlaceholder: "Please enter allergy information or other requests.",
            addToCartBtn: "Add to Cart",
            orderProcessing: "Processing order...",
            orderCompleteAlert: "Order complete.\\nTotal amount: {total}\\nIt will be delivered to your room shortly.",
            itemRemoved: "Item removed from cart.",
            orderConfirmed: "Order successfully placed! (This is a demo order)",
            orderFailEmptyCart: "Your cart is empty. Please select items."
        },
        ja: {
            hotelName: "パシフィック スター リゾート アンド スパ",
            roomInfo: "1205号室 | ルームサービス",
            cartButton: "マイカート",
            categoryPrompt: "何をお探しですか？",
            menuPrompt: "詳細を確認し、注文するにはメニュー項目をクリックしてください。",
            orderHistoryButton: "注文履歴",
            languageButton: "言語",
            orderHistoryTitle: "注文履歴",
            orderHistoryEmpty: "注文履歴がありません。",
            orderHistoryClear: "注文履歴をクリア (デモ)",
            orderSummaryTitle: "ご注文概要",
            expectedTotal: "合計金額",
            taxNotice: "※税金およびサービス料が含まれています。",
            placeOrder: "部屋に注文する",
            cartEmpty: "カートは空です。",
            quantity: "数量",
            specialRequests: "特別リクエスト",
            specialRequestsPlaceholder: "アレルギー情報やその他のリクエストを入力してください。",
            addToCartBtn: "カートに追加",
            orderProcessing: "注文処理中...",
            orderCompleteAlert: "ご注文が完了しました。\\n合計金額: {total}\\nまもなくお部屋にお届けします。",
            itemRemoved: "カートから項目が削除されました。",
            orderConfirmed: "注文が正常に受け付けられました！ (デモ注文です)",
            orderFailEmptyCart: "カートが空です。商品をP選択してください。"
        },
        zh: {
            hotelName: "大酒店",
            roomInfo: "1205房 | 客房服务",
            cartButton: "我的购物车",
            categoryPrompt: "您在寻找什么？",
            menuPrompt: "点击菜单项查看详情并订购。",
            orderHistoryButton: "订单历史",
            languageButton: "语言",
            orderHistoryTitle: "订单历史",
            orderHistoryEmpty: "没有订单历史。",
            orderHistoryClear: "清除订单历史 (演示)",
            orderSummaryTitle: "订单概览",
            expectedTotal: "预计总计",
            taxNotice: "*包含税费和服务费。",
            placeOrder: "送餐到房间",
            cartEmpty: "您的购物车是空的。",
            quantity: "数量",
            specialRequests: "特别要求",
            specialRequestsPlaceholder: "请输入过敏信息或其他要求。",
            addToCartBtn: "加入购物车",
            orderProcessing: "正在处理订单...",
            orderCompleteAlert: "订单已完成。\\n总金额: {total}\\n将很快送到您的房间。",
            itemRemoved: "商品已从购物车中移除。",
            orderConfirmed: "订单已成功提交！ (这是演示订单)",
            orderFailEmptyCart: "您的购物车是空的。请选择商品。"
        }
    };

    const elementsToTranslate = {
        '#app-title': 'hotelName',
        '#app-subtitle': 'roomInfo',
        '#cart-button span:first-of-type': 'cartButton',
        '#order-history-button span:first-of-type': 'orderHistoryButton',
        '#language-button span:first-of-type': 'languageButton',
        '#menu-instruction': 'menuPrompt',
        'nav p.text-lg': 'categoryPrompt',
        '#cart-sidebar h2': 'orderSummaryTitle',
        '#cart-sidebar .font-semibold': 'expectedTotal',
        '#cart-sidebar .text-xs': 'taxNotice',
        '#checkout-button-text': 'placeOrder',
        '#history-modal h2': 'orderHistoryTitle',
        '#clear-history-button span:first-of-type': 'orderHistoryClear'
    };

    function updateTexts() {
        for (const selector in elementsToTranslate) {
            const element = document.querySelector(selector);
            if (element) {
                const translationSpec = elementsToTranslate[selector];
                if (typeof translationSpec === 'object' && translationSpec.attr) {
                    element.setAttribute(translationSpec.attr, translations[currentLanguage][translationSpec.key]);
                } else {
                    element.textContent = translations[currentLanguage][translationSpec];
                }
            }
        }
        renderCategories();
        renderMenu();
        updateCart();
        renderOrderHistory();
        if (!detailModal.classList.contains('hidden')) {
             const currentItemId = modalContent.querySelector('#add-to-cart-button')?.dataset.itemId;
             if (currentItemId) openDetailModal(currentItemId);
        }
    }

    const fixedHeaderArea = document.getElementById('fixed-header-area');
    const mainContent = document.querySelector('main');
    const categoryFilters = document.getElementById('category-filters');
    const menuGrid = document.getElementById('menu-grid');
    const cartButton = document.getElementById('cart-button');
    const cartCount = document.getElementById('cart-count');
    const detailModal = document.getElementById('detail-modal');
    const modalContent = document.getElementById('modal-content');
    const cartSidebar = document.getElementById('cart-sidebar');
    const closeCartButton = document.getElementById('close-cart-button');
    const cartItemsContainer = document.getElementById('cart-items');
    const cartTotal = document.getElementById('cart-total');
    const checkoutButton = document.getElementById('checkout-button');

    const orderHistoryButton = document.getElementById('order-history-button');
    const historyModal = document.getElementById('history-modal');
    const closeHistoryButton = document.getElementById('close-history-button');
    const historyItemsContainer = document.getElementById('history-items');
    const clearHistoryButton = document.getElementById('clear-history-button');

    const languageButton = document.getElementById('language-button');
    const languageDropdown = document.getElementById('language-dropdown');
    
    // Function to adjust padding-top of body based on fixed header height
    function setBodyPaddingTop() {
        const headerHeight = fixedHeaderArea.offsetHeight;
        document.body.style.paddingTop = `${headerHeight}px`;
    }

    function renderCategories() {
        categoryFilters.innerHTML = categories.map(category => `
            <button class="category-btn px-4 py-2 text-sm md:text-base rounded-full font-semibold ${category === activeCategory ? 'active-category' : 'bg-white text-gray-600 hover:bg-amber-100'}" data-category="${category}">
                ${category}
            </button>
        `).join('');
    }

    function renderMenu() {
        const filteredMenu = activeCategory === '전체'
            ? menuData
            : menuData.filter(item => item.category === activeCategory);

        menuGrid.innerHTML = filteredMenu.map(item => `
            <div class="menu-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" data-item-id="${item.id}">
                <img src="${item.image}" alt="${item.name}" class="w-full h-48 object-cover" onerror="this.onerror=null;this.src='${NO_IMAGE_PLACEHOLDER}';">
                <div class="p-4">
                    <h3 class="font-bold text-lg mb-1">${item.name}</h3>
                    <p class="text-gray-500 text-sm mb-4">${item.price.toLocaleString()}원</p>
                </div>
            </div>
        `).join('');
    }
    
    function openDetailModal(itemId) {
        const item = menuData.find(i => i.id === itemId);
        if (!item) return;

        modalContent.innerHTML = `
            <div class="flex-shrink-0">
                <img src="${item.image}" alt="${item.name}" class="w-full h-64 object-cover" onerror="this.onerror=null;this.src='${NO_IMAGE_PLACEHOLDER}';">
            </div>
            <div class="p-6 flex-grow overflow-y-auto custom-scrollbar">
                <div class="flex justify-between items-start">
                    <h2 class="text-3xl font-bold mb-2">${item.name}</h2>
                    <span class="text-2xl font-bold text-amber-700">${item.price.toLocaleString()}원</span>
                </div>
                <p class="text-gray-600 mb-6">${item.description}</p>
                <div class="flex items-center gap-4 mb-6">
                    <span class="font-semibold">${translations[currentLanguage].quantity}</span>
                    <div class="flex items-center border rounded-lg">
                        <button class="quantity-change px-3 py-1 text-lg" data-delta="-1">-</button>
                        <span id="modal-quantity" class="px-4 text-lg font-bold">1</span>
                        <button class="quantity-change px-3 py-1 text-lg" data-delta="1">+</button>
                    </div>
                </div>
                <div>
                    <label for="special-requests" class="block font-semibold mb-2">${translations[currentLanguage].specialRequests}</label>
                    <textarea id="special-requests" rows="3" class="w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-amber-500 focus:border-amber-500" placeholder="${translations[currentLanguage].specialRequestsPlaceholder}"></textarea>
                </div>
            </div>
            <div class="p-6 border-t bg-gray-50 flex-shrink-0">
                <button id="add-to-cart-button" class="w-full bg-amber-600 text-white font-bold py-3 rounded-lg hover:bg-amber-700 transition shadow-lg" data-item-id="${item.id}">
                    <span id="add-to-cart-price">${translations[currentLanguage].addToCartBtn} (${item.price.toLocaleString()}원)</span>
                </button>
            </div>
        `;

        detailModal.classList.remove('hidden');
        setTimeout(() => {
          detailModal.classList.add('opacity-100');
          modalContent.classList.add('scale-100');
        }, 10);

        const quantitySpan = document.getElementById('modal-quantity');
        const priceButtonSpan = document.getElementById('add-to-cart-price');
        
        function updatePrice() {
            const quantity = parseInt(quantitySpan.textContent);
            const totalPrice = item.price * quantity;
            priceButtonSpan.textContent = `${translations[currentLanguage].addToCartBtn} (${totalPrice.toLocaleString()}원)`;
        }

        modalContent.querySelectorAll('.quantity-change').forEach(button => {
            button.addEventListener('click', () => {
                let quantity = parseInt(quantitySpan.textContent);
                quantity = Math.max(1, quantity + parseInt(button.dataset.delta));
                quantitySpan.textContent = quantity;
                updatePrice();
            });
        });
    }

    function closeModal() {
        detailModal.classList.remove('opacity-100');
        modalContent.classList.remove('scale-100');
        setTimeout(() => {
          detailModal.classList.add('hidden');
          modalContent.innerHTML = '';
        }, 300);
    }
    
    function addToCart(itemId) {
        const item = menuData.find(i => i.id === itemId);
        const quantity = parseInt(document.getElementById('modal-quantity').textContent);
        const specialRequests = document.getElementById('special-requests').value;
        const cartItemId = `${itemId}-${Date.now()}`;

        const existingItemIndex = cart.findIndex(ci => ci.id === itemId && ci.specialRequests === specialRequests);

        if (existingItemIndex > -1) {
            cart[existingItemIndex].quantity += quantity;
        } else {
            cart.push({ ...item, cartItemId, quantity, specialRequests });
        }
        
        updateCart();
        closeModal();
        openCart();
    }
    
    function updateCart() {
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        cartCount.textContent = totalItems;
        
        if (cart.length === 0) {
            cartItemsContainer.innerHTML = `<p class="text-center text-gray-500">${translations[currentLanguage].cartEmpty}</p>`;
        } else {
            cartItemsContainer.innerHTML = cart.map(item => `
                <div class="py-4 border-b">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="font-bold">${item.name}</p>
                            <p class="text-sm text-gray-600">${item.price.toLocaleString()}원</p>
                            ${item.specialRequests ? `<p class="text-xs text-amber-600 mt-1">${translations[currentLanguage].specialRequests}: ${item.specialRequests}</p>` : ''}
                        </div>
                        <button class="remove-from-cart text-red-500 hover:text-red-700 text-sm" data-cart-item-id="${item.cartItemId}"><i class="fa-solid fa-trash"></i></button>
                    </div>
                    <div class="flex items-center gap-2 mt-2">
                        <span class="text-sm font-semibold">${translations[currentLanguage].quantity}:</span>
                        <div class="flex items-center border rounded">
                            <button class="cart-quantity-change px-2 py-0.5" data-cart-item-id="${item.cartItemId}" data-delta="-1">-</button>
                            <span class="px-3 text-sm">${item.quantity}</span>
                            <button class="cart-quantity-change px-2 py-0.5" data-cart-item-id="${item.cartItemId}" data-delta="1">+</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        const totalPrice = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
        cartTotal.textContent = `${totalPrice.toLocaleString()}원`;
        
        checkoutButton.disabled = cart.length === 0;

        cartItemsContainer.querySelectorAll('.cart-quantity-change').forEach(button => {
            button.removeEventListener('click', handleCartItemQuantityChange);
            button.addEventListener('click', handleCartItemQuantityChange);
        });
        cartItemsContainer.querySelectorAll('.remove-from-cart').forEach(button => {
            button.removeEventListener('click', handleRemoveFromCart);
            button.addEventListener('click', handleRemoveFromCart);
        });
    }

    function handleCartItemQuantityChange(e) {
        const button = e.target.closest('button');
        if (!button) return;
        const cartItemId = button.dataset.cartItemId;
        const delta = parseInt(button.dataset.delta);
        const itemIndex = cart.findIndex(i => i.cartItemId === cartItemId);
        if (itemIndex > -1) {
            cart[itemIndex].quantity += delta;
            if (cart[itemIndex].quantity <= 0) {
                cart.splice(itemIndex, 1);
            }
        }
        updateCart();
    }
    
    function handleRemoveFromCart(e) {
        const button = e.target.closest('button');
        if (!button) return;
        const cartItemId = button.dataset.cartItemId;
        cart = cart.filter(item => item.cartItemId !== cartItemId);
        updateCart();
    }

    function openCart() {
        cartSidebar.classList.remove('translate-x-full');
    }

    function closeCart() {
        cartSidebar.classList.add('translate-x-full');
    }

    function handleCheckout() {
        if(cart.length === 0) {
            alert(translations[currentLanguage].orderFailEmptyCart);
            return;
        }

        const checkoutBtnText = document.getElementById('checkout-button-text');
        checkoutBtnText.innerHTML = `<i class="fa-solid fa-spinner fa-spin mr-2"></i>${translations[currentLanguage].orderProcessing}`;
        checkoutButton.disabled = true;

        setTimeout(() => {
            const totalAmount = cartTotal.textContent;
            alert(translations[currentLanguage].orderCompleteAlert.replace('{total}', totalAmount));
            
            // Add current cart items to order history (for demo)
            orderHistory.unshift({
                id: `ORD-${Date.now()}`,
                items: JSON.parse(JSON.stringify(cart)), // Deep copy
                total: totalAmount,
                timestamp: new Date().toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : currentLanguage === 'ja' ? 'ja-JP' : currentLanguage === 'zh' ? 'zh-CN' : 'en-US'),
                status: '주문 완료' // For history display
            });

            cart = [];
            updateCart();
            closeCart();
            checkoutBtnText.innerHTML = translations[currentLanguage].placeOrder;
            renderOrderHistory(); // Update history modal if open
        }, 2000);
    }

    function openOrderHistoryModal() {
        renderOrderHistory();
        historyModal.classList.remove('hidden');
        setTimeout(() => {
            historyModal.classList.add('opacity-100');
        }, 10);
    }

    function closeOrderHistoryModal() {
        historyModal.classList.remove('opacity-100');
        setTimeout(() => {
            historyModal.classList.add('hidden');
        }, 300);
    }

    function renderOrderHistory() {
        if (orderHistory.length === 0) {
            historyItemsContainer.innerHTML = `<p class="text-center text-gray-500">${translations[currentLanguage].orderHistoryEmpty}</p>`;
        } else {
            historyItemsContainer.innerHTML = orderHistory.map(order => `
                <div class="py-4 border-b">
                    <p class="font-bold text-lg mb-1">${translations[currentLanguage].orderHistoryTitle.split(' ')[0]} ID: ${order.id}</p>
                    <p class="text-sm text-gray-600 mb-2">시간: ${order.timestamp}</p>
                    <ul class="list-disc list-inside text-sm text-gray-700 mb-2">
                        ${order.items.map(item => `<li>${item.name} x ${item.quantity} (${item.price.toLocaleString()}원) ${item.specialRequests ? `(${translations[currentLanguage].specialRequests}: ${item.specialRequests})` : ''}</li>`).join('')}
                    </ul>
                    <div class="flex justify-between items-center">
                        <span class="font-semibold text-amber-700">${translations[currentLanguage].expectedTotal.split(' ')[0]}: ${order.total}</span>
                        <span class="text-sm px-2 py-1 rounded-full bg-green-100 text-green-700">${order.status}</span>
                    </div>
                </div>
            `).join('');
        }
        clearHistoryButton.disabled = orderHistory.length === 0;
    }

    function clearOrderHistory() {
        if (confirm(translations[currentLanguage].orderHistoryClear.replace(' (데모)', '').replace('(Demo)', '') + "?")) {
            orderHistory = [];
            renderOrderHistory();
        }
    }

    function toggleLanguageDropdown() {
        languageDropdown.classList.toggle('hidden');
    }

    function setLanguage(lang) {
        currentLanguage = lang;
        updateTexts();
        toggleLanguageDropdown();
    }

    // Screensaver Logic
    const SCREENSAVER_IDLE_TIME = 60 * 1000; // 1 minute in milliseconds
    let idleTimer;
    let screensaverActive = false;
    let currentScreensaverImageIndex = 0;
    let screensaverImageInterval;

    const screensaverImages = [
        //'https://images.pexels.com/photos/338504/pexels-photo-338504.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2', // Updated to a working hotel image
        //'https://images.pexels.com/photos/258154/pexels-photo-258154.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2', // Updated to a working hotel image
        //'https://images.pexels.com/photos/271639/pexels-photo-271639.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2', // Hotel pool
        //'https://images.pexels.com/photos/261102/pexels-photo-261102.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2', // Hotel restaurant
        //'https://images.pexels.com/photos/258154/pexels-photo-258154.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2', // Hotel exterior
        //'https://images.pexels.com/photos/189296/pexels-photo-189296.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' // New hotel lobby/reception image
		'https://images.trvl-media.com/lodging/1000000/530000/522900/522824/a1740666.jpg?impolicy=resizecrop&rw=1200&ra=fit',
		'https://images.trvl-media.com/lodging/1000000/530000/522900/522824/0a03c7e8.jpg?impolicy=resizecrop&rw=1200&ra=fit',
		'https://images.trvl-media.com/lodging/1000000/530000/522900/522824/41eed097.jpg?impolicy=resizecrop&rw=1200&ra=fit',
		'https://images.trvl-media.com/lodging/1000000/530000/522900/522824/d9f7a148.jpg?impolicy=resizecrop&rw=1200&ra=fit',
		'https://images.trvl-media.com/lodging/1000000/530000/522900/522824/c76f4bd6.jpg?impolicy=resizecrop&rw=1200&ra=fit',
		'https://images.trvl-media.com/lodging/1000000/530000/522900/522824/e6885ab9.jpg?impolicy=resizecrop&rw=1200&ra=fit',
		'https://images.trvl-media.com/lodging/1000000/530000/522900/522824/0b944fe9.jpg?impolicy=resizecrop&rw=1200&ra=fit',
		'https://images.trvl-media.com/lodging/1000000/530000/522900/522824/98e3cb7f.jpg?impolicy=resizecrop&rw=1200&ra=fit',
		'https://images.trvl-media.com/lodging/1000000/530000/522900/522824/a882396f.jpg?impolicy=resizecrop&rw=1200&ra=fit'
    ];

    const screensaverDiv = document.getElementById('screensaver');
    const screensaverImage = document.getElementById('screensaver-image');

    function resetIdleTimer() {
        clearTimeout(idleTimer);
        idleTimer = setTimeout(startScreensaver, SCREENSAVER_IDLE_TIME);
        if (screensaverActive) {
            hideScreensaver();
        }
    }

    function startScreensaver() {
        screensaverActive = true;
        screensaverDiv.classList.remove('hidden'); // 컨테이너를 보이게 하여 레이아웃을 잡습니다.
        screensaverDiv.style.opacity = '0'; // 초기에는 투명하게 시작합니다.
        screensaverImage.style.opacity = '0'; // 이미지도 투명하게 시작합니다.

        currentScreensaverImageIndex = 0; // 첫 번째 이미지로 인덱스를 초기화합니다.
        screensaverImage.src = screensaverImages[currentScreensaverImageIndex]; // 첫 번째 이미지를 즉시 설정합니다.

        setTimeout(() => {
            screensaverDiv.style.opacity = '1'; // 검은색 배경을 페이드인합니다.
            screensaverImage.style.opacity = '1'; // 이미지를 함께 페이드인합니다.
            // 초기 이미지가 완전히 나타난 후 이미지 변경 간격을 시작합니다.
            screensaverImageInterval = setInterval(changeScreensaverImage, 5000);
        }, 100); // 초기 렌더링에 필요한 약간의 지연을 줍니다.
    }

    function changeScreensaverImage() {
        if (!screensaverActive) return;

        screensaverImage.style.opacity = '0'; // 현재 이미지를 1초 동안 페이드아웃합니다.

        setTimeout(() => {
            currentScreensaverImageIndex = (currentScreensaverImageIndex + 1) % screensaverImages.length;
            screensaverImage.src = screensaverImages[currentScreensaverImageIndex];
            screensaverImage.style.opacity = '1'; // 새로운 이미지를 1초 동안 페이드인합니다.
        }, 1000); // 페이드아웃이 완료될 때까지 기다린 후 src를 변경하고 페이드인합니다.
    }

    function hideScreensaver() {
        screensaverImage.style.opacity = '0'; // 현재 이미지를 1초 동안 먼저 페이드아웃합니다.
        clearInterval(screensaverImageInterval);

        setTimeout(() => {
            screensaverDiv.style.opacity = '0'; // 이미지가 페이드아웃된 후 검은색 배경을 1초 동안 페이드아웃합니다.
        }, 1000); // 이미지 페이드아웃이 완료될 때까지 기다립니다 (1초).

        setTimeout(() => {
            screensaverDiv.classList.add('hidden'); // 완전히 페이드아웃된 후 div를 숨깁니다 (총 2초 소요).
            screensaverActive = false;
            screensaverImage.src = ''; // 메모리 절약을 위해 이미지 소스를 지웁니다.
        }, 2000); // 이미지와 div가 모두 페이드아웃되어 숨겨질 때까지의 총 시간입니다.
    }

    // Event Listeners
    categoryFilters.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON') {
            activeCategory = e.target.dataset.category;
            renderCategories();
            renderMenu();
        }
    });

    menuGrid.addEventListener('click', (e) => {
        const card = e.target.closest('.menu-card');
        if (card) {
            openDetailModal(card.dataset.itemId);
        }
    });
    
    detailModal.addEventListener('click', (e) => {
        if (e.target === detailModal) {
            closeModal();
        }
        if (e.target.closest('#add-to-cart-button')) {
            addToCart(e.target.closest('#add-to-cart-button').dataset.itemId);
        }
    });
    
    cartButton.addEventListener('click', openCart);
    closeCartButton.addEventListener('click', closeCart);
    checkoutButton.addEventListener('click', handleCheckout);

    cartItemsContainer.addEventListener('click', (e) => {
        const quantityButton = e.target.closest('.cart-quantity-change');
        const removeButton = e.target.closest('.remove-from-cart');
        
        if (quantityButton) {
            handleCartItemQuantityChange(e); // Pass the event object directly
        }
        if (removeButton) {
            handleRemoveFromCart(e); // Pass the event object directly
        }
    });

    orderHistoryButton.addEventListener('click', openOrderHistoryModal);
    closeHistoryButton.addEventListener('click', closeOrderHistoryModal);
    clearHistoryButton.addEventListener('click', clearOrderHistory);

    languageButton.addEventListener('click', toggleLanguageDropdown);
    languageDropdown.addEventListener('click', (e) => {
        if (e.target.tagName === 'A' && e.target.dataset.lang) {
            setLanguage(e.target.dataset.lang);
            e.preventDefault();
        }
    });

    document.addEventListener('click', (e) => {
        if (!languageButton.contains(e.target) && !languageDropdown.contains(e.target)) {
            languageDropdown.classList.add('hidden');
        }
    });

    // Add event listeners for user activity for screensaver
    ['mousemove', 'keydown', 'click', 'scroll'].forEach(eventType => {
        document.addEventListener(eventType, resetIdleTimer);
    });

    // Add click listener to screensaver itself to hide it
    screensaverDiv.addEventListener('click', hideScreensaver);

    // Initial Render and padding adjustment
    updateTexts();
    setBodyPaddingTop(); // Initial padding adjustment
    window.addEventListener('resize', setBodyPaddingTop); // Adjust padding on window resize
    resetIdleTimer(); // Start the initial idle timer
});
</script>

</body>
</html>
